!function(t,e,i,n,a){var r=e.isSupportTouch?"tap":"click";var s=n.regBaseCom2Lib("COMS.PT.BetPool","onChange onDelete onAdd onEdit onRandom onClear",{config:{wrap:"",highlight:"ddactive",inedit:"inEdit",inDel:"inDel",useServerRandom:true,serverRandomUrl:"",random:null,edit:null,adapter:null,counter:null,serialize:null,animate:true},init:function(t){this.config=e.extend({},this.config,t||{});if(!e.isFunction(this.config.random)){alert("没有提供机选算法接口random，初始化失败！","pool001");return}if(!e.isFunction(this.config.edit)){alert("没有提供投注数据修改接口edit，初始化失败！","pool002");return}if(!e.isFunction(this.config.adapter)){alert("没有提供数据转化器adapter，初始化失败！","pool003");return}if(!e.isFunction(this.config.counter)){alert("没有提供数据统计器counter，初始化失败！","pool004");return}var i=e(this.config.wrap);if(!i[0]){alert("号码篮容器设置错误，初始化失败！","pool005");return}if(!i.find(":first-child")[0])i.html("<dl></dl>");this.config.wrap=i;var n=this;i.css(e.fx.cssPrefix+"user-select","none");i.delegate("a[rel=betPoolAct]",r,function(t){var i=e(this),a=i.attr("pid")||0,r=this.hash.substr(1);switch(r){case"del":n.del(a)}return false}).delegate("dd",r,function(t){var i=e(this),a=i.attr("gid");if("A"==(t.target.nodeName||"").toUpperCase()||i.hasClass(n.config.inDel))return;n.__edit(a)});this.cache={list:i.find("dl"),data:[],guid:1}},push:function(){return this.push2(Array.prototype.slice.call(arguments,0))},push2:function(t,e){if("array"!==n.getType(t))return this;this.notHeightLight=!!e;this.insert(null,1,t);delete this.notHeightLight;return this},getData:function(){return this.cache.data.slice(0)},serialize:function(){if(!e.isFunction(this.config.serialize)){alert("没有提供数据序列化接口serialize！","pool006");return""}return this.config.serialize(this.getData())},getCount:function(t){var e=0,i=0,n=t||this.cache.data,a=n.length,r=0,s;for(;r<a;r++){s=this.config.counter(n[r]);if(!s||2!=s.length)alert("数据统计器返回值错误！","pool007");else{e+=s[0];i+=s[1]}}return[e,i]},insert:function(t,i,n,r){var s=this.cache.data,c=s.length,h=this,o,l,f=r==a?"onAdd":r,d,u=0==c||0==t?0:!t?c:-1,g;if(u<0)e.each(s,function(e,n){if(n.guid==+t){u=i>0?e+1:e;return}});if(u<0)return this;if(h.config.dataChecker){o=h.config.dataChecker(n).fixData;if(!e.isArray(o)){console&&console.log&&console.log("数据检查器dataChecker返回值错误!");o=n.slice(0)}}else o=n.slice(0);if(!o.length)return this;e.each(o,function(t,e){o[t]=h.__setGuid(e)});l=[].concat(s.slice(0,u),o,s.slice(u));if(f)if(false===this.callEvent(f,o,l))return this;g=[];e.each(o,function(t,e){g[t]=h.__getItem(e,e.guid)});g=e(g.join(""));if(0==u)this.cache.list.prepend(g).scrollTop(0);else if(!t)this.cache.list.append(g).scrollTop(this.cache.list[0].scrollHeight);else{var p=this.cache.list.find("dd[gid="+t+"]"),m=p.height(),v=p.offset().top-this.cache.list.offset().top+m,_=v-this.cache.list.height()+m,C=this.cache.list.scrollTop();p[i>0?"after":"before"](g);if(curPos<_||C>v)this.cache.list.scrollTop(parseInt((_+v)/2))}if(1==n.length&&h.config.animate){d=this.cache.list.offset();g.css(e.fx.cssPrefix+"transform","translateX("+-d.width+"px)").animate({translateX:0},500,"ease")}this.__highlight(o);this.cache.data=l;f&&this.callEvent("onChange",f.replace(/^on/g,"").toLowerCase());return this},refresh:function(){var t=this,i=this.cache,n;e.each(i.data,function(e,a){n=i.list.find('dd[gid="'+a.guid+'"]');n.html(t.__getContent(a,a.guid))});this.callEvent("onChange","onRefresh")},del:function(t){var e=this.__inCache(t),i,n,a,r,s;if(e<0)return this;i=this.cache.data;n=i[e];a=[].concat(i.slice(0,e),i.slice(e+1));if(false===this.callEvent("onDelete",n,a))return this;r=this.cache.list.find('dd[gid="'+t+'"]');if(this.config.animate){r.find("a[rel=betPoolAct]").hide();s=this.cache.list.offset();r.animate({translateX:-s.width+"px"},500,"ease");setTimeout(function(){r.remove()},500)}else r.remove();this.cache.data=a;this.callEvent("onChange","del");return this},clear:function(){var t=this.cache.data,e=t.length;if(0==e)return this;if(false===this.callEvent("onClear"))return this;this.cache.list.empty().html("");this.cache.data.length=0;this.callEvent("onChange","clear");return this},edit:function(t,e){var i=this.__inCache(t),n,a;if(!e)return this;if(i>=0&&false===this.callEvent("onEdit",this.cache.data[i],e))return this;if(i<0)return this.push(e);n=this.cache.list.find("dd[gid='"+t+"']");a=this.__setGuid(e,t);n.after(this.__getItem(a,a.guid));n.remove();this.cache.data[i]=a;this.__highlight([a]);this.callEvent("onChange","edit");return this},__edit:function(t){var e=this,i=e.cache.data,n=e.config.inedit,a=e.__inCache(t);if(a>=0){e.cache.list.find("."+n).removeClass(n);e.cache.list.find("[gid='"+t+"']").addClass(n);e.config.edit(t,e.cache.data[a])}return this},random:function(n,a){var r=n||1,s=this,c=this.config.serverRandomUrl,h,o,l=function(t){var i=s.config.random(t,r);if(!i||!i.length){alert("机选算法接口返回值错误！","pool008");return}if(false===s.callEvent("onRandom",t?"server":"client",i))return;s.insert(0,-1,i,"");s.callEvent("onChange","random");e.isFunction(a)&&a(i);l=e.noop};if(this.config.useServerRandom&&c){h=e.isFunction(c)?c.call(this.config)||"":c;!h?l(""):i.get(h.replace(/{n}/g,r),function(e,i){o&&t.clearTimeout(o);l(e?"":i)},"@randomJX");o=t.setTimeout(function(){l("")},300)}else l("");return this},__getItem:function(t,e){var i="<dd gid="+e+">"+this.config.adapter(t)+"</dd>",a={edit:"",del:'<a rel="betPoolAct" pid="'+e+'" href="#del" class="roundDeleBtn"><i></i></a>'};return n.format(i,a)},__getContent:function(t,e){var i=this.config.adapter(t),a={edit:"",del:'<a rel="betPoolAct" pid="'+e+'" href="#del" class="roundDeleBtn"><i></i></a>'};return n.format(i,a)},__setGuid:function(t,e){if(t.guid)return t;var i=n.getType(t),a;switch(i){case"string":a=new String(t);break;case"number":a=new Number(t);break;default:a=t}a.guid=e||this.cache.guid++;return a},__inCache:function(t,e){var i=e||this.cache.data,n=i.length,a=0;for(;a<n;a++)if(i[a].guid==+t)return a;return-1},__highlight:function(t){return}})}(window,Zepto,Core,Game);