function hide_selection_pane(){$("#field_selection").fadeOut("fast");$("#entries_actions").fadeIn()}function show_selection_pane(){$("#filter_pane").hide();$("#entries_actions").fadeOut();$("#field_selection").fadeIn()}function show_filter_pane(){$("#field_selection").hide();$("#entries_actions").fadeOut();$("#filter_pane").fadeIn()}function hide_filter_pane(){$("#filter_pane").fadeOut();$("#entries_actions").fadeIn()}$(function(){$("#entry_select_field").click(function(){if($("#field_selection").is(":visible")){hide_selection_pane()}else{show_selection_pane()}return false});$("#field_selection_cancel").click(function(){hide_selection_pane();return false});$("#me_edit_filter").click(function(){show_filter_pane();return false});$("#filter_pane_cancel").click(function(){hide_filter_pane();return false});$("#entry_filter").click(function(){if($("#filter_pane").is(":visible")){hide_filter_pane()}else{show_filter_pane()}return false});$("#me_filter_pane_submit").click(function(){$(this).val("Applying...");$(this).prop("disabled",true);$("#cancel_filter_pane_span").hide();$(this).after("<span id='field_select_loader'><img src='images/loader_small_grey.gif' style='vertical-align: middle;margin-left: 5px'/></span>");var a=new Array();$("#filter_pane li.filter_settings").each(function(b){a[b]=$(this).data("filter_properties")});$.ajax({type:"POST",async:true,url:"save_filter_users.php",data:{filter_prop:a,filter_type:$("#filter_all_any").val()},cache:false,global:false,dataType:"json",error:function(d,b,c){},success:function(b){if(b.status=="ok"){window.location.replace("manage_users.php")}}})});$("#me_sort_by").bind("change",function(){var a=$(this).val();window.location.replace("manage_users.php?sortby="+a)});$("#filter_pane").delegate("select.condition_fieldname","change",function(c){var a=$(this).val();var b=$("#filter_pane").data(a);$(this).parent().find(".condition_text,.condition_number,.condition_admin,.condition_status,input.text").hide();if(b=="number"){$(this).parent().find(".condition_number,input.text").show();$(this).parent().data("filter_properties").condition=$(this).parent().find(".condition_number").val()}else{if(b=="admin"){$(this).parent().find(".condition_admin").show();$(this).parent().data("filter_properties").condition=$(this).parent().find(".condition_admin").val()}else{if(b=="status"){$(this).parent().find(".condition_status").show();$(this).parent().data("filter_properties").condition=$(this).parent().find(".condition_status").val()}else{$(this).parent().find(".condition_text,input.text").show();$(this).parent().data("filter_properties").condition=$(this).parent().find(".condition_text").val()}}}$(this).parent().data("filter_properties").element_name=a});$("#filter_pane").delegate("select.condition_text,select.condition_number,select.condition_admin,select.condition_status","change",function(a){$(this).parent().data("filter_properties").condition=$(this).val()});$("#filter_pane").delegate("input.text","keyup mouseout change",function(a){$(this).parent().data("filter_properties").keyword=$(this).val()});$("#filter_pane").delegate("a.filter_delete_a","click",function(a){if($("#filter_pane li:not('.filter_add')").length<=1){$("#ui-dialog-title-dialog-warning").html("Unable to delete!");$("#dialog-warning-msg").html("You can't delete all filter condition! <br />You must have at least 1 filter condition.");$("#dialog-warning").dialog("open")}else{$(this).parent().fadeOut(function(){$(this).remove()})}return false});$("#dialog-warning").dialog({modal:true,autoOpen:false,closeOnEscape:false,width:600,position:["center","center"],draggable:false,resizable:false,open:function(){$(this).next().find("button").blur()},buttons:[{text:"OK","class":"bb_button bb_small bb_green",click:function(){$(this).dialog("close")}}]});$("#filter_add_a").click(function(){var b=$("#filter_pane li:not('.filter_add')").length+1;var a=b-1;var c=$("#filter_pane ul > li:not('.filter_add')").last();c.clone(false).data("filter_properties",$.extend("{}",c.data("filter_properties"))).find("*[id],*[name]").each(function(){var e=$(this).attr("id").split("_");var d=b-1;$(this).attr("id",e[0]+"_"+b);$(this).attr("name",e[0]+"_"+b)}).end().attr("id","li_"+b).insertBefore("#li_filter_add").hide().fadeIn();$("#filterfield_"+b).val($("#filterfield_"+a).val());$("#conditiontext_"+b).val($("#conditiontext_"+a).val());$("#conditionnumber_"+b).val($("#conditionnumber_"+a).val());$("#conditiondate_"+b).val($("#conditiondate_"+a).val());$("#conditionfile_"+b).val($("#conditionfile_"+a).val());$("#conditioncheckbox_"+b).val($("#conditioncheckbox_"+a).val());$("#filterkeyword_"+b).val("");$("#li_"+b).data("filter_properties").keyword="";return false});$("#me_clear_filter").click(function(){if($(this).text()=="Clear Filter"){$(this).text("Clearing...");$("#filter_info").append("<img src='images/loader_small_grey.gif' style='position: absolute;right: -20px;top:18px'/>");$.ajax({type:"POST",async:true,url:"clear_filter_users.php",cache:false,global:false,dataType:"json",error:function(c,a,b){},success:function(a){if(a.status=="ok"){window.location.replace("manage_users.php")}}})}});$("#col_select").click(function(){var b=$("#entries_table tbody > tr").length;var d=$("#me_entries_total").text();var a="";if($("#filter_info").length>0){a="filtered results"}else{a="system"}var c='<tr class="entries_select_all"><td colspan="'+$("#entries_table th").length+'">All '+b+' users on this page are selected. <a href="#" id="me_select_all">Select all <strong>'+d+"</strong> users in this "+a+"</td></tr>";if($(this).prop("checked")==true){$("#entries_table input[type='checkbox']:not('#col_select')").prop("checked",true);$("#entries_table tr").addClass("me_row_selected");$("#entries_table tbody").prepend(c)}else{$("#entries_table input[type='checkbox']:not('#col_select')").prop("checked",false);$("#entries_table tr.me_row_selected").removeClass("me_row_selected");$("#entries_table .entries_select_all").remove();$("#col_select").data("full_selection",0)}});$("#entries_table").delegate("#me_select_all","click",function(){var c=$("#me_entries_total").text();var b="";if($("#filter_info").length>0){b="filtered results"}else{b="form"}var a="All "+c+" entries in this "+b+' are selected. <a id="me_clear_selection" href="#">Clear selection</a>';$(".entries_select_all td").html(a);$("#col_select").data("full_selection",1);return false});$("#entries_table").delegate("#me_clear_selection","click",function(){$("#entries_table input[type='checkbox']").prop("checked",false);$("#entries_table .entries_select_all").remove();$("#entries_table tr.me_row_selected").removeClass("me_row_selected");$("#col_select").data("full_selection",0);return false});$("#entries_table input[type='checkbox']:not('#col_select')").click(function(){if($(this).prop("checked")==true){$(this).parent().parent().addClass("me_row_selected")}else{$(this).parent().parent().removeClass("me_row_selected");$("#entries_table .entries_select_all").remove();$("#col_select").prop("checked",false);$("#col_select").data("full_selection",0)}});$("#col_select").data("full_selection",0);$("#dialog-confirm-user-delete").dialog({modal:true,autoOpen:false,closeOnEscape:false,width:550,position:["center","center"],draggable:false,resizable:false,open:function(){$("#btn-confirm-user-delete-ok").blur()},buttons:[{text:"Yes. Delete selected users",id:"btn-confirm-user-delete-ok","class":"bb_button bb_small bb_green",click:function(){$("#btn-confirm-user-delete-ok").prop("disabled",true);$("#btn-confirm-user-delete-cancel").hide();$("#btn-confirm-user-delete-ok").text("Deleting...");$("#btn-confirm-user-delete-ok").after("<div class='small_loader_box'><img src='images/loader_small_grey.gif' /></div>");var a=$("#entries_options").data("formid");var b=$("#entries_table input[type='checkbox']:not('#col_select'):checked").serializeArray();$.ajax({type:"POST",async:true,url:"change_user_status.php",data:{action:"delete",delete_all:$("#col_select").data("full_selection"),selected_users:b},cache:false,global:false,dataType:"json",error:function(f,c,d){},success:function(c){if(c.status=="ok"){window.location.replace("manage_users.php?id")}}})}},{text:"Cancel",id:"btn-confirm-user-delete-cancel","class":"btn_secondary_action",click:function(){$(this).dialog("close")}}]});$("#dialog-confirm-user-suspend").dialog({modal:true,autoOpen:false,closeOnEscape:false,width:550,position:["center","center"],draggable:false,resizable:false,open:function(){$("#btn-confirm-user-suspend-ok").blur()},buttons:[{text:"Yes. Suspend selected entries",id:"btn-confirm-user-suspend-ok","class":"bb_button bb_small bb_green",click:function(){$("#btn-confirm-user-suspend-ok").prop("disabled",true);$("#btn-confirm-user-suspend-cancel").hide();$("#btn-confirm-user-suspend-ok").text("Suspending...");$("#btn-confirm-user-suspend-ok").after("<div class='small_loader_box'><img src='images/loader_small_grey.gif' /></div>");var a=$("#entries_table input[type='checkbox']:not('#col_select'):checked").serializeArray();$.ajax({type:"POST",async:true,url:"change_user_status.php",data:{action:"suspend",delete_all:$("#col_select").data("full_selection"),selected_users:a},cache:false,global:false,dataType:"json",error:function(d,b,c){},success:function(b){if(b.status=="ok"){window.location.replace("manage_users.php")}}})}},{text:"Cancel",id:"btn-confirm-user-suspend-cancel","class":"btn_secondary_action",click:function(){$(this).dialog("close")}}]});$("#user_delete").click(function(){var b=$("#entries_table input[type='checkbox']:not('#col_select'):checked").length;if(b>0){if($("#col_select").data("full_selection")==1){if($("#filter_info").length>0){$("#ui-dialog-title-dialog-confirm-user-delete").html("Are you sure you want to delete selected users?");$("#dialog-confirm-user-delete-info").html("The selected users will be deleted.");$("#btn-confirm-user-delete-ok").text("Yes. Delete selected users")}else{$("#ui-dialog-title-dialog-confirm-user-delete").html("Are you sure you want to delete all users?");$("#dialog-confirm-user-delete-info").html("<span style='font-size: 125%'>ALL users</span> (except Main Administrator) will be deleted.");$("#btn-confirm-user-delete-ok").text("Yes. Delete all users")}}else{if(b==1){var a=$("#entries_table input[type='checkbox']:not('#col_select'):checked").attr("id").split("_");$("#ui-dialog-title-dialog-confirm-user-delete").html("Are you sure you want to delete the user?");$("#dialog-confirm-user-delete-info").html("The user with <span style='font-size: 125%'>ID #"+a[1]+"</span> will be deleted.");$("#btn-confirm-user-delete-ok").text("Yes. Delete user #"+a[1])}else{$("#ui-dialog-title-dialog-confirm-user-delete").html("Are you sure you want to delete selected users?");$("#dialog-confirm-user-delete-info").html("The selected <span style='font-size: 125%'>"+b+" users</span> will be deleted.");$("#btn-confirm-user-delete-ok").text("Yes. Delete selected users")}}$("#dialog-confirm-user-delete").dialog("open")}else{$("#ui-dialog-title-dialog-warning").html("No user selected");$("#dialog-warning-msg").html("You haven't selected any user.<br />Please select at least one user to be deleted.");$("#dialog-warning").dialog("open")}return false});$("#user_suspend").click(function(){var b=$("#entries_table input[type='checkbox']:not('#col_select'):checked").length;if(b>0){if($("#col_select").data("full_selection")==1){if($("#filter_info").length>0){$("#ui-dialog-title-dialog-confirm-user-suspend").html("Are you sure you want to suspend selected users?");$("#dialog-confirm-user-suspend-info").html("The selected users will be suspended.");$("#btn-confirm-user-suspend-ok").text("Yes. Suspend selected users")}else{$("#ui-dialog-title-dialog-confirm-user-suspend").html("Are you sure you want to suspend all users?");$("#dialog-confirm-user-suspend-info").html("<span style='font-size: 125%'>ALL users</span> (except Main Administrator) will be suspended.");$("#btn-confirm-user-suspend-ok").text("Yes. Suspend all users")}}else{if(b==1){var a=$("#entries_table input[type='checkbox']:not('#col_select'):checked").attr("id").split("_");$("#ui-dialog-title-dialog-confirm-user-suspend").html("Are you sure you want to suspend the user?");$("#dialog-confirm-user-suspend-info").html("The user with <span style='font-size: 125%'>ID #"+a[1]+"</span> will be suspended.");$("#btn-confirm-user-suspend-ok").text("Yes. Suspend user #"+a[1])}else{$("#ui-dialog-title-dialog-confirm-user-suspend").html("Are you sure you want to suspend selected users?");$("#dialog-confirm-user-suspend-info").html("The selected <span style='font-size: 125%'>"+b+" users</span> will be suspended.");$("#btn-confirm-user-suspend-ok").text("Yes. Suspend selected users")}}$("#dialog-confirm-user-suspend").dialog("open")}else{$("#ui-dialog-title-dialog-warning").html("No user selected");$("#dialog-warning-msg").html("You haven't selected any user.<br />Please select at least one user to be suspended.");$("#dialog-warning").dialog("open")}return false});$("#entries_table tbody td:not('.me_action')").click(function(){var b=$(this).parent().attr("id").split("_");var a=b[1];window.location.href="view_user.php?id="+a})});