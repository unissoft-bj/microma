function mf_submit_payment(){var e=null;var h=null;var j=null;var g=null;var c=null;var b=null;var d=null;var f=null;var i=null;var a=null;e=$("#cc_first_name").val().trim()+" "+$("#cc_last_name").val().trim();e=$.trim(e);h=$("#cc_number").val().trim();if($("#cc_cvv").val().trim().length>0){j=$("#cc_cvv").val().trim()}g=$("#cc_expiry_month").val();c=$("#cc_expiry_year").val();if($("#li_billing_address").length>0){b=$("#billing_street").val().trim();d=$("#billing_city").val().trim();f=$("#billing_state").val().trim();i=$("#billing_zipcode").val().trim();a=$("#billing_country").val().trim()}Stripe.createToken({number:h,cvc:j,exp_month:g,exp_year:c,name:e,address_line1:b,address_city:d,address_state:f,address_zip:i,address_country:a},mf_stripe_response_handler)}function mf_stripe_response_handler(g,f){if(f.error){$("#btn_submit_payment").prop("disabled",false);$("#btn_submit_payment").val($("#btn_submit_payment").data("originallabel"));$("#mf_payment_loader_img").hide();$("#error_message").show();$("#li_credit_card").addClass("error");$("#credit_card_error_message").html(f.error.message).show();if($("html").hasClass("embed")){$.postMessage({mf_iframe_height:$("body").outerHeight(true)},"*",parent)}alert("There was a problem with your submission. Please check highlighted fields.")}else{var k=f.id;var h=1;if($("#mf_same_shipping_address").prop("checked")==true){h=1}else{h=0}var b="";var d="";var e="";var m="";var a="";var j="";var i="";var o="";var c="";var l="";if($("#li_billing_address").length>0){b=$("#billing_street").val().trim();d=$("#billing_city").val().trim();e=$("#billing_state").val().trim();m=$("#billing_zipcode").val().trim();a=$("#billing_country").val().trim()}if($("#li_shipping_address").length>0){j=$("#shipping_street").val().trim();i=$("#shipping_city").val().trim();o=$("#shipping_state").val().trim();c=$("#shipping_zipcode").val().trim();l=$("#shipping_country").val().trim()}var n={first_name:$("#cc_first_name").val().trim(),last_name:$("#cc_last_name").val().trim(),billing_street:b,billing_city:d,billing_state:e,billing_zipcode:m,billing_country:a,same_shipping_address:h,shipping_street:j,shipping_city:i,shipping_state:o,shipping_zipcode:c,shipping_country:l};$.ajax({type:"POST",async:true,url:$("#main_body").data("machformpath")+"payment_submit_stripe.php",data:{token:k,form_id:$("#form_id").val(),payment_properties:n},cache:false,global:false,dataType:"json",error:function(r,p,q){$("#error_message").show();$("#li_credit_card").addClass("error");$("#credit_card_error_message").html("Unknown Error. Please contact tech support.").show();$("#btn_submit_payment").prop("disabled",false);$("#btn_submit_payment").val($("#btn_submit_payment").data("originallabel"));$("#mf_payment_loader_img").hide();if($("html").hasClass("embed")){$.postMessage({mf_iframe_height:$("body").outerHeight(true)},"*",parent)}alert("There was a problem with your submission. Please check highlighted fields.")},success:function(p){if(p.status=="ok"){$("#form_payment_redirect").submit()}else{$("#error_message").show();$("#li_credit_card").addClass("error");$("#credit_card_error_message").html(p.message).show();$("#btn_submit_payment").prop("disabled",false);$("#btn_submit_payment").val($("#btn_submit_payment").data("originallabel"));$("#mf_payment_loader_img").hide();if($("html").hasClass("embed")){$.postMessage({mf_iframe_height:$("body").outerHeight(true)},"*",parent)}alert("There was a problem with your submission. Please check highlighted fields.")}}})}}function mf_clear_errors(){$("#error_message").hide();$("li.error").removeClass("error");$("#credit_card_error_message").html("");$("#shipping_error_message").html("");$("#billing_error_message").html("")}function mf_validate_fields(){var a=true;if(Stripe.validateCardNumber($("#cc_number").val().trim())==false){$("#error_message").show();$("#li_credit_card").addClass("error");$("#credit_card_error_message").html("Your credit card number is incorrect. Please enter correct number.").show();a=false}if($("#li_billing_address").length>0){if($("#billing_street").val().trim().length==0||$("#billing_city").val().trim().length==0||$("#billing_state").val().trim().length==0||$("#billing_zipcode").val().trim().length==0||$("#billing_country").val().trim().length==0){$("#error_message").show();$("#li_billing_address").addClass("error");$("#billing_error_message").html("The field is required. Please enter a complete billing address.").show();a=false}}if($("#li_shipping_address").length>0){if($("#mf_same_shipping_address").prop("checked")==false){if($("#shipping_street").val().trim().length==0||$("#shipping_city").val().trim().length==0||$("#shipping_state").val().trim().length==0||$("#shipping_zipcode").val().trim().length==0||$("#shipping_country").val().trim().length==0){$("#error_message").show();$("#li_shipping_address").addClass("error");$("#shipping_error_message").html("The field is required. Please enter a complete shipping address.").show();a=false}}}return a}$(function(){$("#mf_same_shipping_address").bind("change",function(){if($(this).prop("checked")==true){$(".shipping_address_detail").hide()}else{$(".shipping_address_detail").show()}if($("html").hasClass("embed")){$.postMessage({mf_iframe_height:$("body").outerHeight(true)},"*",parent)}});$("form.appnitro").submit(function(){var a=false;$("#btn_submit_payment").val("Processing. Please wait...");$("#btn_submit_payment").prop("disabled",true);$("#mf_payment_loader_img").show();mf_clear_errors();a=mf_validate_fields();if(a===true){mf_submit_payment()}else{$("#btn_submit_payment").prop("disabled",false);$("#btn_submit_payment").val($("#btn_submit_payment").data("originallabel"));$("#mf_payment_loader_img").hide();if($("html").hasClass("embed")){$.postMessage({mf_iframe_height:$("body").outerHeight(true)},"*",parent)}alert("There was a problem with your submission. Please check highlighted fields.")}return false})});