function hide_selection_pane(){$("#field_selection").fadeOut("fast");$("#entries_actions").fadeIn()}function show_selection_pane(){$("#filter_pane").hide();$("#entries_actions").fadeOut();$("#field_selection").fadeIn()}function show_filter_pane(){$("#field_selection").hide();$("#entries_actions").fadeOut();$("#filter_pane").fadeIn()}function hide_filter_pane(){$("#filter_pane").fadeOut();$("#entries_actions").fadeIn()}function select_date(g){var f=g[0].getMonth()+1;var b=g[0].getDate();var d=g[0].getFullYear();var a=$(this).attr("id").split("_");var e=a[1];var c=f+"/"+b+"/"+d;$("#filterkeyword_"+e).val(c);$("#li_"+e).data("filter_properties").keyword=c}$(function(){$("#entry_select_field").click(function(){if($("#field_selection").is(":visible")){hide_selection_pane()}else{show_selection_pane()}return false});$("#field_selection_cancel").click(function(){hide_selection_pane();return false});$("#me_edit_filter").click(function(){show_filter_pane();return false});$("#filter_pane_cancel").click(function(){hide_filter_pane();return false});$("#entry_filter").click(function(){if($("#filter_pane").is(":visible")){hide_filter_pane()}else{show_filter_pane()}return false});$("#me_field_select_submit").click(function(){$(this).val("Applying...");$(this).prop("disabled",true);$("#cancel_field_select_span").hide();$(this).after("<span id='field_select_loader'><img src='images/loader_small_grey.gif' style='vertical-align: middle;margin-left: 5px'/></span>");var b=$("#entries_options").data("formid");var c=$("#field_selection input.checkbox:checked").serializeArray();$.ajax({type:"POST",async:true,url:"save_column_preference.php",data:{form_id:b,col_pref:c},cache:false,global:false,dataType:"json",error:function(g,d,f){},success:function(d){if(d.status=="ok"){window.location.replace("manage_entries.php?id="+d.form_id)}}})});$("#me_filter_pane_submit").click(function(){$(this).val("Applying...");$(this).prop("disabled",true);$("#cancel_filter_pane_span").hide();$(this).after("<span id='field_select_loader'><img src='images/loader_small_grey.gif' style='vertical-align: middle;margin-left: 5px'/></span>");var b=$("#entries_options").data("formid");var c=new Array();$("#filter_pane li.filter_settings").each(function(d){c[d]=$(this).data("filter_properties")});$.ajax({type:"POST",async:true,url:"save_filter.php",data:{form_id:b,filter_prop:c,filter_type:$("#filter_all_any").val()},cache:false,global:false,dataType:"json",error:function(g,d,f){},success:function(d){if(d.status=="ok"){window.location.replace("manage_entries.php?id="+d.form_id)}}})});$("#me_sort_by").bind("change",function(){var c=$("#entries_options").data("formid");var b=$(this).val();window.location.replace("manage_entries.php?id="+c+"&sortby="+b)});$("#filter_pane").delegate("select.condition_fieldname","change",function(d){var b=$(this).val();var c=$("#filter_pane").data(b);$(this).parent().find(".condition_text,.condition_number,.condition_date,.condition_file,.condition_checkbox,input.text").hide();$(this).parent().removeClass("filter_date");if(c=="money"||c=="number"){$(this).parent().find(".condition_number,input.text").show();$(this).parent().data("filter_properties").condition=$(this).parent().find(".condition_number").val()}else{if(c=="date"||c=="europe_date"){$(this).parent().addClass("filter_date");$(this).parent().find(".condition_date,input.text").show();$(this).parent().data("filter_properties").condition=$(this).parent().find(".condition_date").val()}else{if(c=="file"){$(this).parent().find(".condition_file,input.text").show();$(this).parent().data("filter_properties").condition=$(this).parent().find(".condition_file").val()}else{if(c=="checkbox"){$(this).parent().find(".condition_checkbox").show();$(this).parent().data("filter_properties").condition=$(this).parent().find(".condition_checkbox").val()}else{$(this).parent().find(".condition_text,input.text").show();$(this).parent().data("filter_properties").condition=$(this).parent().find(".condition_text").val()}}}}$(this).parent().data("filter_properties").element_name=b});$("#filter_pane").delegate("select.condition_text,select.condition_number,select.condition_date,select.condition_file,select.condition_checkbox","change",function(b){$(this).parent().data("filter_properties").condition=$(this).val()});$("#filter_pane").delegate("input.text","keyup mouseout change",function(b){$(this).parent().data("filter_properties").keyword=$(this).val()});$("#filter_pane").delegate("a.filter_delete_a","click",function(b){if($("#filter_pane li:not('.filter_add')").length<=1){$("#ui-dialog-title-dialog-warning").html("Unable to delete!");$("#dialog-warning-msg").html("You can't delete all filter condition! <br />You must have at least 1 filter condition.");$("#dialog-warning").dialog("open")}else{$(this).parent().fadeOut(function(){$(this).remove()})}return false});$("#dialog-warning").dialog({modal:true,autoOpen:false,closeOnEscape:false,width:600,position:["center","center"],draggable:false,resizable:false,open:function(){$(this).next().find("button").blur()},buttons:[{text:"OK","class":"bb_button bb_small bb_green",click:function(){$(this).dialog("close")}}]});$("#dialog-export-entries").dialog({modal:true,autoOpen:false,closeOnEscape:false,width:600,position:["center","center"],draggable:false,resizable:false,open:function(){$(this).next().find("button").blur()},buttons:[{text:"Close","class":"bb_button bb_small bb_green",click:function(){$(this).dialog("close")}}]});$("#filter_add_a").click(function(){var c=$("#filter_pane li:not('.filter_add')").length+1;var b=c-1;var d=$("#filter_pane ul > li:not('.filter_add')").last();d.clone(false).data("filter_properties",$.extend("{}",d.data("filter_properties"))).find("*[id],*[name]").each(function(){var g=$(this).attr("id").split("_");var f=c-1;$(this).attr("id",g[0]+"_"+c);$(this).attr("name",g[0]+"_"+c)}).end().attr("id","li_"+c).insertBefore("#li_filter_add").hide().fadeIn();$("#filterfield_"+c).val($("#filterfield_"+b).val());$("#conditiontext_"+c).val($("#conditiontext_"+b).val());$("#conditionnumber_"+c).val($("#conditionnumber_"+b).val());$("#conditiondate_"+c).val($("#conditiondate_"+b).val());$("#conditionfile_"+c).val($("#conditionfile_"+b).val());$("#conditioncheckbox_"+c).val($("#conditioncheckbox_"+b).val());$("#filterkeyword_"+c).val("");$("#li_"+c).data("filter_properties").keyword="";$("#datepicker_"+c).next().next().remove();$("#datepicker_"+c).next().remove();$("#datepicker_"+c).remove();var e='<input type="hidden" value="" name="datepicker_'+c+'" id="datepicker_'+c+'"><span style="display:none"><img id="datepickimg_'+c+'" alt="Pick date." src="images/icons/calendar.png" class="trigger filter_date_trigger" style="vertical-align: top; cursor: pointer" /></span>';$("#filterkeyword_"+c).after(e);$("#datepicker_"+c).datepick({onSelect:select_date,showTrigger:"#datepickimg_"+c});return false});$("#me_clear_filter").click(function(){if($(this).text()=="Clear Filter"){$(this).text("Clearing...");$("#filter_info").append("<img src='images/loader_small_grey.gif' style='position: absolute;right: -20px;top:18px'/>");var b=$("#entries_options").data("formid");$.ajax({type:"POST",async:true,url:"clear_filter.php",data:{form_id:b},cache:false,global:false,dataType:"json",error:function(f,c,d){},success:function(c){if(c.status=="ok"){window.location.replace("manage_entries.php?id="+c.form_id)}}})}});var a=$("#filter_pane li").length-1;for(i=1;i<=a;i++){$("#datepicker_"+i).datepick({onSelect:select_date,showTrigger:"#datepickimg_"+i})}$("#col_select").click(function(){var c=$("#entries_table tbody > tr").length;var e=$("#me_entries_total").text();var b="";if($("#filter_info").length>0){b="filtered results"}else{b="form"}var d='<tr class="entries_select_all"><td colspan="'+$("#entries_table th").length+'">All '+c+' entries on this page are selected. <a href="#" id="me_select_all">Select all <strong>'+e+"</strong> entries in this "+b+"</td></tr>";if($(this).prop("checked")==true){$("#entries_table input[type='checkbox']:not('#col_select')").prop("checked",true);$("#entries_table tr").addClass("me_row_selected");$("#entries_table tbody").prepend(d)}else{$("#entries_table input[type='checkbox']:not('#col_select')").prop("checked",false);$("#entries_table tr.me_row_selected").removeClass("me_row_selected");$("#entries_table .entries_select_all").remove();$("#col_select").data("full_selection",0)}});$("#entries_table").delegate("#me_select_all","click",function(){var d=$("#me_entries_total").text();var c="";if($("#filter_info").length>0){c="filtered results"}else{c="form"}var b="All "+d+" entries in this "+c+' are selected. <a id="me_clear_selection" href="#">Clear selection</a>';$(".entries_select_all td").html(b);$("#col_select").data("full_selection",1);return false});$("#entries_table").delegate("#me_clear_selection","click",function(){$("#entries_table input[type='checkbox']").prop("checked",false);$("#entries_table .entries_select_all").remove();$("#entries_table tr.me_row_selected").removeClass("me_row_selected");$("#col_select").data("full_selection",0);return false});$("#entries_table input[type='checkbox']:not('#col_select')").click(function(){if($(this).prop("checked")==true){$(this).parent().parent().addClass("me_row_selected")}else{$(this).parent().parent().removeClass("me_row_selected");$("#entries_table .entries_select_all").remove();$("#col_select").prop("checked",false);$("#col_select").data("full_selection",0)}});$("#col_select").data("full_selection",0);$("#dialog-confirm-entry-delete").dialog({modal:true,autoOpen:false,closeOnEscape:false,width:550,position:["center","center"],draggable:false,resizable:false,open:function(){$("#btn-confirm-entry-delete-ok").blur()},buttons:[{text:"Yes. Delete selected entries",id:"btn-confirm-entry-delete-ok","class":"bb_button bb_small bb_green",click:function(){$("#btn-confirm-entry-delete-ok").prop("disabled",true);$("#btn-confirm-entry-delete-cancel").hide();$("#btn-confirm-entry-delete-ok").text("Deleting...");$("#btn-confirm-entry-delete-ok").after("<div class='small_loader_box'><img src='images/loader_small_grey.gif' /></div>");var b=$("#entries_options").data("formid");var c=$("#entries_table input[type='checkbox']:not('#col_select'):checked").serializeArray();$.ajax({type:"POST",async:true,url:"delete_entries.php",data:{form_id:b,delete_all:$("#col_select").data("full_selection"),selected_entries:c},cache:false,global:false,dataType:"json",error:function(g,d,f){},success:function(d){if(d.status=="ok"){window.location.replace("manage_entries.php?id="+d.form_id)}}})}},{text:"Cancel",id:"btn-confirm-entry-delete-cancel","class":"btn_secondary_action",click:function(){$(this).dialog("close")}}]});$("#entry_delete").click(function(){var c=$("#entries_table input[type='checkbox']:not('#col_select'):checked").length;if(c>0){if($("#col_select").data("full_selection")==1){if($("#filter_info").length>0){$("#ui-dialog-title-dialog-confirm-entry-delete").html("Are you sure you want to delete selected entries?");$("#dialog-confirm-entry-delete-info").html("Data and files associated with your selected <span style='font-size: 125%'>"+$("#me_entries_total").text()+" entries</span> will be deleted.");$("#btn-confirm-entry-delete-ok").text("Yes. Delete selected entries")}else{$("#ui-dialog-title-dialog-confirm-entry-delete").html("Are you sure you want to delete all entries?");$("#dialog-confirm-entry-delete-info").html("Data and files associated with <span style='font-size: 125%'>ALL entries</span> will be deleted.");$("#btn-confirm-entry-delete-ok").text("Yes. Delete all entries")}}else{if(c==1){var b=$("#entries_table input[type='checkbox']:not('#col_select'):checked").attr("id").split("_");$("#ui-dialog-title-dialog-confirm-entry-delete").html("Are you sure you want to delete the entry?");$("#dialog-confirm-entry-delete-info").html("Data and files associated with <span style='font-size: 125%'>entry #"+b[1]+"</span> will be deleted.");$("#btn-confirm-entry-delete-ok").text("Yes. Delete entry #"+b[1])}else{$("#ui-dialog-title-dialog-confirm-entry-delete").html("Are you sure you want to delete selected entries?");$("#dialog-confirm-entry-delete-info").html("Data and files associated with your selected <span style='font-size: 125%'>"+c+" entries</span> will be deleted.");$("#btn-confirm-entry-delete-ok").text("Yes. Delete selected entries")}}$("#dialog-confirm-entry-delete").dialog("open")}else{$("#ui-dialog-title-dialog-warning").html("No entry selected");$("#dialog-warning-msg").html("You haven't selected any entry.<br />Please select at least one entry to be deleted.");$("#dialog-warning").dialog("open")}return false});$("#entry_export").click(function(){$("#dialog-export-entries").dialog("open");return false});$("#dialog-export-entries a").click(function(j){var d=$("#entries_options").data("formid");var h=$("#col_select").data("full_selection");var g=$("#entries_table input[type='checkbox']:not('#col_select'):checked");var c=$(this).attr("id");var b="xls";if(c=="export_as_excel"){b="xls"}if(c=="export_as_csv"){b="csv"}if(c=="export_as_txt"){b="txt"}j.preventDefault();if(h==1){window.location.href="export_entries.php?type="+b+"&form_id="+d}else{if(g.length>0){var k=g.serializeArray();var f=new Array();$.each(k,function(e,l){f[e]=(l.name.split("_"))[1]});window.location.href="export_entries.php?type="+b+"&form_id="+d+"&entries_id="+f.join(",")}else{window.location.href="export_entries.php?type="+b+"&form_id="+d}}return false});$("#entries_table tbody td:not('.me_action')").click(function(){var b=$("#entries_options").data("formid");var c=$(this).parent().attr("id").split("_");var d=c[1];window.location.href="view_entry.php?form_id="+b+"&entry_id="+d})});